import"./index.DcofHP4a.js";import{b as w}from"./entry.mqcdfM2I.js";import{p as k}from"./stores.CqvaitLm.js";import{q as A}from"./scheduler.BEzZnZ7Q.js";import{r as M}from"./runtime.9lnYnD0Q.js";function N(t,n){if(t==="")return"";const e=new URL(t,n).pathname;return e.endsWith("/")?e.slice(0,-1):e}function $(t,n){const e=X(t),o=U(e,n),[a,s]=K(o);return[a,s]}const E=(t,n,e)=>[n,t,e??""].filter(o=>o!=="/").join("")||"/";function U(t,n){const e=t.replace(n,"");return e.startsWith("/")?e:`/${e}`}function K(t){const e=["/.html__data.json","/__data.json"].find(o=>t.endsWith(o));return e?[t.slice(0,-e.length)||"/",e]:[t,void 0]}function X(t){try{return decodeURI(t)}catch{return t}}const q=t=>({url:n})=>{try{const[e,o]=$(n.pathname,w),a=t.getLanguageFromLocalisedPath(e);if(!a)return n.pathname;const s=t.getCanonicalPath(e,a);return E(s,w,o)}catch{return n.pathname}};function H(t){return`/${t.split("/").filter(Boolean).join("/")}`}function Q(t){const n=t.map(e=>typeof e=="string"?o=>o===e:o=>e.test(o));return e=>n.some(o=>o(H(e)))}const L="rtl",R="ltr";function Y(t){try{const n=new Intl.Locale(t);return"textInfo"in n?n.textInfo.direction===L?L:R:n.getTextInfo().direction===L?L:R}catch{return R}}function G(t){const n=t.map(e=>[e,Y(e)]);return Object.fromEntries(n)}const J=0,F=1,S=2,Z=4,d=0,x=1,y=2;function V(t){const n=tt(et);return t.sort((e,o)=>{var a,s,i,c,r,u;const l=O(e).map(n),f=O(o).map(n);for(let h=0;h<Math.max(l.length,f.length);h+=1){const g=l[h],v=f[h];if(!g)return-1;if(!v)return 1;for(let _=0;_<Math.max(g.length,v.length);_+=1){const p=g[_],m=v[_];if((p==null?void 0:p[d])||(m==null?void 0:m[d])){if(!p)return-1;if(!m)return 1;const T=((a=g[_+1])==null?void 0:a[x])||((i=(s=l[h+1])==null?void 0:s[0])==null?void 0:i[x]),I=((c=v[_+1])==null?void 0:c[x])||((u=(r=f[h+1])==null?void 0:r[0])==null?void 0:u[x]),z=T&&I,P=T&&!I,W=!T&&I;if((p[d]&&m[d])===S){if(z)continue;if(P)return-1;if(W)return 1}if(p[d]===S)return P?-1:1;if(m[d]===S)return W?1:-1;if(p[y]!==m[y])return(-1)**+p[y];if(p[d]!==m[d])return(-1)**+(p[d]>m[d])}else if((p==null?void 0:p[x])!==(m==null?void 0:m[x]))return nt(p[x],m[x])}}return e<o?1:-1})}function tt(t){const n=new Map;return e=>(n.has(e)||n.set(e,t(e)),n.get(e))}function et(t){const n=[];let e=0;for(;e<=t.length;){const o=t.indexOf("[",e),a=o===-1;if(n.push([J,t.slice(e,a?void 0:o),!1]),a)break;const s=t[o+1]==="["?F:t[o+1]==="."?S:Z,i=s===F?"]]":"]",c=t.indexOf(i,o);if(c===-1)throw new Error(`Invalid route definition ${t}`);const r=t.slice(o,e=c+i.length);n.push([s,r,r.includes("=")])}return n}const O=t=>t.replace(/\[\[[^\]]+\]\](?!$)/g,"").split("/").filter(Boolean);function nt(t,n){if(t===n)return 0;let e=0;for(;t[e]===n[e];)e++;return t[e]?n[e]?t[e]<n[e]?-1:1:-1:1}const rt=/^(\[)?(\.\.\.)?(\w+)(?:=(\w+))?(\])?$/;function ot(t){const n=[];return{pattern:t==="/"?/^\/$/:new RegExp(`^${D(t).map(o=>{const a=/^\[\.\.\.(\w+)(?:=(\w+))?\]$/.exec(o);if(a)return n.push({name:a[1],matcher:a[2],optional:!1,rest:!0,chained:!0}),"(?:/(.*))?";const s=/^\[\[(\w+)(?:=(\w+))?\]\]$/.exec(o);if(s)return n.push({name:s[1],matcher:s[2],optional:!0,rest:!1,chained:!0}),"(?:/([^/]+))?";if(!o)return;const i=o.split(/\[(.+?)\](?!\])/);return"/"+i.map((r,u)=>{if(u%2){if(r.startsWith("x+"))return j(String.fromCharCode(parseInt(r.slice(2),16)));if(r.startsWith("u+"))return j(String.fromCharCode(...r.slice(2).split("-").map(_=>parseInt(_,16))));const l=rt.exec(r);if(!l)throw new Error(`Invalid param: ${r}`);const[,f,h,g,v]=l;return n.push({name:g,matcher:v,optional:!!f,rest:!!h,chained:h?u===1&&i[0]==="":!1}),h?"(.*?)":f?"([^/]*)?":"([^/]+?)"}return j(r)}).join("")}).join("")}/?$`),params:n}}function st(t,n,e){const o={},a=t.slice(1),s=a.filter(c=>c!==void 0);let i=0;for(const[c,r]of n.entries()){let u=a[c-i];if(r.chained&&r.rest&&i&&(u=a.slice(c-i,c+1).filter(f=>f).join("/"),i=0),u===void 0){r.rest&&(o[r.name]="");continue}if(r.matcher&&!e[r.matcher])return;if((e[r.matcher]??(()=>!0))(u)){o[r.name]=u;const f=n[c+1],h=a[c+1];f&&!f.rest&&f.optional&&h&&r.chained&&(i=0),!f&&!h&&Object.keys(o).length===s.length&&(i=0);continue}if(r.optional&&r.chained){i++;continue}return}if(!i)return o}function j(t){return t.normalize().replace(/[[\]]/g,"\\$&").replace(/%/g,"%25").replace(/\//g,"%2[Ff]").replace(/\?/g,"%3[Ff]").replace(/#/g,"%23").replace(/[.*+?^${}()|\\]/g,"\\$&")}const it=/\[(\[)?(\.\.\.)?(\w+?)(?:=(\w+))?\]\]?/g;function b(t,n){return"/"+D(t).map(e=>e.replace(it,(o,a,s,i)=>{const c=n[i];if(!c){if(a||s&&c!==void 0)return"";throw new Error(`Missing parameter '${i}' in route ${t}`)}if(c[0]=="/"||c.endsWith("/"))throw new Error(`Parameter '${i}' in route ${t} cannot start or end with a slash`);return c})).filter(Boolean).join("/")}function C(t,n,e){const o=V(n);for(const a of o){const s=ot(a),i=s.pattern.exec(at(t));if(!i)continue;const c=st(i,s.params,e);if(c)return{params:c,id:a}}}const at=t=>t.endsWith("/")?t.slice(0,-1):t,D=t=>t.slice(1).split("/");function ct(t,n,e,o,a){function s(r){const l=r.split("/")[1];if(t.includes(l)&&(a==="always"||l!==n))return l;if(a==="never")return n}function i(r,u){const l=r.endsWith("/")&&r!=="/";r=l?r.slice(0,-1):r;let f=ft(r,u,e,o);return l&&(f+="/"),(a==="always"||u!==n)&&(f=`/${u}${f}`),f}function c(r,u){const l=r.endsWith("/")&&r!=="/";(a==="always"||u!==n)&&(r=r.replace(`/${u}`,"")||"/");const f=l;r=f?r.slice(0,-1):r;let h=ut(r,u,e,o);return f&&(h+="/"),h}return{getLanguageFromLocalisedPath:s,getLocalisedPath:i,getCanonicalPath:c}}function ut(t,n,e,o){for(const[a,s]of Object.entries(e)){if(!(n in s))continue;const i=s[n];if(!i)continue;const c=C(t,[i],o);if(c)return b(a,c.params)}return t}function ft(t,n,e,o){const a=C(t,Object.keys(e),o);if(!a)return t;const s=e[a.id];if(!s)return t;const i=s[n];return i?b(i,a.params):t}function lt(t,n){const e={},o=[],a=t.sourceLanguageTag,s={defaultLanguageTag:a,runtime:t,translations:e,matchers:{},exclude:Q(o),prefixDefaultLanguage:"never",textDirection:G(t.availableLanguageTags),seo:{noAlternateLinks:!1}},i=ct(t.availableLanguageTags,a,s.translations,s.matchers,s.prefixDefaultLanguage);return Object.freeze(e),Object.freeze(s),{config:s,strategy:i,reroute:()=>q(i),handle:()=>{throw new Error("")},getLanguageFromUrl(c){const r=B(w),[u]=$(c.pathname,r);return s.exclude(u)?s.defaultLanguageTag:i.getLanguageFromLocalisedPath(u)||s.defaultLanguageTag},resolveRoute(c,r=void 0){if(s.exclude(c))return c;const u=B(w),[l,f]=$(c,u);if(r=r??t.languageTag(),!c.startsWith(u))return c;const h=i.getLocalisedPath(l,r);return E(h,u,f)},route(c){const r=B(w),[u,l]=$(c,r),h=i.getLanguageFromLocalisedPath(u)||s.defaultLanguageTag,g=i.getCanonicalPath(u,h);return E(g,r,l)}}}function B(t){return t===""?"":t.startsWith("/")?t:N(t,new URL(A(k).url))}const xt=lt(M);export{xt as i,N as n,$ as p,E as s};
